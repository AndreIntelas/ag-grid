var __defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(t,e,r)=>e in t?__defProp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,__spreadValues=(t,e)=>{for(var r in e||(e={}))__hasOwnProp.call(e,r)&&__defNormalProp(t,r,e[r]);if(__getOwnPropSymbols)for(var r of __getOwnPropSymbols(e))__propIsEnum.call(e,r)&&__defNormalProp(t,r,e[r]);return t},__export=(t,e)=>{for(var r in e)__defProp(t,r,{get:e[r],enumerable:!0})},__copyProps=(t,e,r,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of __getOwnPropNames(e))!__hasOwnProp.call(t,i)&&i!==r&&__defProp(t,i,{get:()=>e[i],enumerable:!(s=__getOwnPropDesc(e,i))||s.enumerable});return t},__toCommonJS=t=>__copyProps(__defProp({},"__esModule",{value:!0}),t),__decorateClass=(t,e,r,s)=>{for(var i=s>1?void 0:s?__getOwnPropDesc(e,r):e,a=t.length-1,o;a>=0;a--)(o=t[a])&&(i=(s?o(e,r,i):o(i))||i);return s&&i&&__defProp(e,r,i),i},main_exports={};__export(main_exports,{MasterDetailModule:()=>MasterDetailModule}),module.exports=__toCommonJS(main_exports);var import_core3=require("@ag-grid-community/core"),import_core4=require("@ag-grid-enterprise/core"),import_core2=require("@ag-grid-community/core"),import_core=require("@ag-grid-community/core"),DetailCellRendererCtrl=class extends import_core.BeanStub{constructor(){super(...arguments),this.loadRowDataVersion=0}init(t,e){this.params=e,this.comp=t,e.pinned==null&&(this.setAutoHeightClasses(),this.setupRefreshStrategy(),this.addThemeToDetailGrid(),this.createDetailGrid(),this.loadRowData(),this.addManagedListener(this.eventService,import_core.Events.EVENT_FULL_WIDTH_ROW_FOCUSED,this.onFullWidthRowFocused.bind(this)))}onFullWidthRowFocused(t){const e=this.params,r={rowIndex:e.node.rowIndex,rowPinned:e.node.rowPinned},s={rowIndex:t.rowIndex,rowPinned:t.rowPinned};this.rowPositionUtils.sameRow(r,s)&&this.focusService.focusInto(this.comp.getGui(),t.fromBelow)}setAutoHeightClasses(){const t=this.gridOptionsService.get("detailRowAutoHeight"),e=t?"ag-details-row-auto-height":"ag-details-row-fixed-height",r=t?"ag-details-grid-auto-height":"ag-details-grid-fixed-height";this.comp.addOrRemoveCssClass(e,!0),this.comp.addOrRemoveDetailGridCssClass(r,!0)}setupRefreshStrategy(){const t=this.params.refreshStrategy;if(t=="everything"||t=="nothing"||t=="rows"){this.refreshStrategy=t;return}t!=null&&console.warn("AG Grid: invalid cellRendererParams.refreshStrategy = '"+t+"' supplied, defaulting to refreshStrategy = 'rows'."),this.refreshStrategy="rows"}addThemeToDetailGrid(){const{theme:t}=this.environment.getTheme();t&&this.comp.addOrRemoveDetailGridCssClass(t,!0)}createDetailGrid(){if(import_core._.missing(this.params.detailGridOptions)){console.warn("AG Grid: could not find detail grid options for master detail, please set gridOptions.detailCellRendererParams.detailGridOptions");return}const t=this.gridOptionsService.get("detailRowAutoHeight"),e=__spreadValues({},this.params.detailGridOptions);t&&(e.domLayout="autoHeight"),this.comp.setDetailGrid(e)}registerDetailWithMaster(t,e){const r=this.params.node.id,s=this.params.api,i={id:r,api:t,columnApi:e},a=this.params.node;s.addDetailGridInfo(r,i),a.detailGridInfo=i,this.addDestroyFunc(()=>{a.detailGridInfo===i&&(s.removeDetailGridInfo(r),a.detailGridInfo=null)})}loadRowData(){var t,e,r;this.loadRowDataVersion++;const s=this.loadRowDataVersion;if(((t=this.params.detailGridOptions)==null?void 0:t.rowModelType)==="serverSide"){(r=(e=this.params.node.detailGridInfo)==null?void 0:e.api)==null||r.refreshServerSide({purge:!0});return}const i=this.params.getDetailRowData;if(!i){console.warn("AG Grid: could not find getDetailRowData for master / detail, please set gridOptions.detailCellRendererParams.getDetailRowData");return}const a=n=>{this.loadRowDataVersion===s&&this.comp.setRowData(n)},o={node:this.params.node,data:this.params.node.data,successCallback:a,context:this.gridOptionsService.getGridCommonParams().context};i(o)}refresh(){switch(this.refreshStrategy){case"nothing":return!0;case"everything":return!1}return this.loadRowData(),!0}};__decorateClass([(0,import_core.Autowired)("rowPositionUtils")],DetailCellRendererCtrl.prototype,"rowPositionUtils",2),__decorateClass([(0,import_core.Autowired)("focusService")],DetailCellRendererCtrl.prototype,"focusService",2);var _DetailCellRenderer=class l extends import_core2.Component{init(e){this.params=e,this.selectAndSetTemplate();const r={addOrRemoveCssClass:(s,i)=>this.addOrRemoveCssClass(s,i),addOrRemoveDetailGridCssClass:(s,i)=>this.eDetailGrid.classList.toggle(s,i),setDetailGrid:s=>this.setDetailGrid(s),setRowData:s=>this.setRowData(s),getGui:()=>this.eDetailGrid};this.ctrl=this.createManagedBean(new DetailCellRendererCtrl),this.ctrl.init(r,e)}refresh(){return this.ctrl&&this.ctrl.refresh()}destroy(){super.destroy()}selectAndSetTemplate(){if(this.params.pinned){this.setTemplate('<div class="ag-details-row"></div>');return}const e=()=>{this.setTemplate(l.TEMPLATE)};if(import_core2._.missing(this.params.template))e();else if(typeof this.params.template=="string")this.setTemplate(this.params.template);else if(typeof this.params.template=="function"){const r=this.params.template,s=r(this.params);this.setTemplate(s)}else console.warn("AG Grid: detailCellRendererParams.template should be function or string"),e();this.eDetailGrid==null&&console.warn('AG Grid: reference to eDetailGrid was missing from the details template. Please add ref="eDetailGrid" to the template.')}setDetailGrid(e){if(!this.eDetailGrid)return;const r=this.context.getBean("agGridReact"),s=r?import_core2._.cloneObject(r):void 0,i=this.context.getBean("frameworkComponentWrapper"),a=this.getFrameworkOverrides(),o=(0,import_core2.createGrid)(this.eDetailGrid,e,{frameworkOverrides:a,providedBeanInstances:{agGridReact:s,frameworkComponentWrapper:i},modules:import_core2.ModuleRegistry.__getGridRegisteredModules(this.params.api.getGridId())});this.detailApi=o,this.ctrl.registerDetailWithMaster(o,new import_core2.ColumnApi(o)),this.addDestroyFunc(()=>{o?.destroy()})}setRowData(e){this.detailApi&&this.detailApi.setGridOption("rowData",e)}};_DetailCellRenderer.TEMPLATE=`<div class="ag-details-row" role="gridcell">
            <div ref="eDetailGrid" class="ag-details-grid" role="presentation"></div>
        </div>`,__decorateClass([(0,import_core2.RefSelector)("eDetailGrid")],_DetailCellRenderer.prototype,"eDetailGrid",2);var DetailCellRenderer=_DetailCellRenderer,VERSION="31.2.1",MasterDetailModule={version:VERSION,moduleName:import_core3.ModuleNames.MasterDetailModule,beans:[],userComponents:[{componentName:"agDetailCellRenderer",componentClass:DetailCellRenderer}],controllers:[{controllerName:"detailCellRenderer",controllerClass:DetailCellRendererCtrl}],dependantModules:[import_core4.EnterpriseCoreModule]};
