var O=Object.defineProperty,P=Object.getOwnPropertyDescriptor,u=(e,t,r,o)=>{for(var s=o>1?void 0:o?P(t,r):t,n=e.length-1,a;n>=0;n--)(a=e[n])&&(s=(o?a(t,r,s):a(s))||s);return o&&s&&O(t,r,s),s};import{Component as R,Prop as f,Vue as _}from"vue-property-decorator";import{Bean as I,ComponentUtil as D,Events as M,createGrid as b}from"ag-grid-community";import{BaseComponentWrapper as y,Bean as A}from"ag-grid-community";import F from"vue";var m=class{static getComponentType(e,t){if(typeof t=="string"){const r=this.searchForComponentInstance(e,t);return r?F.extend(r):(console.error(`Could not find component with name of ${t}. Is it in Vue.components?`),null)}else return t}static createAndMountComponent(e,t,r){const o={data:{params:Object.freeze(e)},parent:r};r.componentDependencies&&r.componentDependencies.forEach(n=>o[n]=r[n]);const s=new t(o);return s.$mount(),s}static searchForComponentInstance(e,t,r=10,o=!1){let s=null,n=e.$parent,a=0;for(;!s&&n&&n.$options&&++a<r;)s=n.$options.components[t],n=n.$parent;return!s&&!o?(console.error(`Could not find component with name of ${t}. Is it in Vue.components?`),null):s}},w=class extends y{constructor(e){super(),this.parent=e}createWrapper(e){const t=this;class r extends v{init(n){super.init(n)}hasMethod(n){return o.getFrameworkComponentInstance()[n]!=null}callMethod(n,a){const g=this.getFrameworkComponentInstance();return o.getFrameworkComponentInstance()[n].apply(g,a)}addMethod(n,a){o[n]=a}overrideProcessing(n){return t.parent.autoParamsRefresh&&n==="refresh"}processMethod(n,a){return n==="refresh"&&(this.getFrameworkComponentInstance().params=a[0]),this.hasMethod(n)?this.callMethod(n,a):n==="refresh"}createComponent(n){return t.createComponent(e,n)}}const o=new r;return o}createComponent(e,t){const r=m.getComponentType(this.parent,e);if(r)return m.createAndMountComponent(t,r,this.parent)}createMethodProxy(e,t,r){return function(){return e.overrideProcessing(t)?e.processMethod(t,arguments):e.hasMethod(t)?e.callMethod(t,arguments):(r&&console.warn("AG Grid: Framework component is missing the method "+t+"()"),null)}}destroy(){this.parent=null}};w=u([A("frameworkComponentWrapper")],w);var v=class{getGui(){return this.component.$el}destroy(){this.getFrameworkComponentInstance()&&typeof this.getFrameworkComponentInstance().destroy=="function"&&this.getFrameworkComponentInstance().destroy(),this.component.$destroy()}getFrameworkComponentInstance(){return this.component}init(e){this.component=this.createComponent(e)}};import{ComponentUtil as l}from"ag-grid-community";var T=()=>{const e={gridOptions:{default(){return{}}},rowDataModel:void 0},t=["context","popupParent"],r=l.ALL_PROPERTIES.filter(i=>!t.includes(i)),o=(i,c)=>{const p={};return i.forEach(h=>{c[h]!==l.VUE_OMITTED_PROPERTY&&(p[h]=c[h])}),p},s=(i,c,p)=>{if(!p.gridCreated||!p.api)return;const h={};Object.entries(c).forEach(([C,E])=>{i[C]!==E&&(h[C]=E)}),l.processOnChange(h,p.api)},n={props(){return o(r,this)},shallowProps(){return o(t,this)}},a={rowDataModel(i,c){!this.gridCreated||!this.api||i!==c&&(i&&c&&i.length===c.length&&i.every((p,h)=>p===c[h])||l.processOnChange({rowData:i},this.api))},props:{handler(i,c){s(c,i,this)},deep:!0},shallowProps:{handler(i,c){s(c,i,this)},deep:!1}};return l.ALL_PROPERTIES.forEach(i=>{e[i]={default:l.VUE_OMITTED_PROPERTY}}),[e,n,a,{prop:"rowDataModel",event:"data-model-changed"}]};import{VanillaFrameworkOverrides as k}from"ag-grid-community";var L=class extends k{constructor(e){super("vue"),this.parent=e}frameworkComponent(e,t){let r=!!m.searchForComponentInstance(this.parent,e,10,!0),o=r?e:null;if(!o&&t&&t[e]){const s=t[e];r=!!m.searchForComponentInstance(this.parent,s,10,!0),o=r?s:null}return o}isFrameworkComponent(e){return typeof e=="object"}},[$,S,V,B]=T(),d=class extends _{constructor(){super(...arguments),this.gridCreated=!1,this.isDestroyed=!1,this.gridReadyFired=!1,this.api=void 0,this.emitRowModel=null}static kebabProperty(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}render(e){return e("div")}globalEventListenerFactory(e){return(t,r)=>{if(this.isDestroyed)return;t==="gridReady"&&(this.gridReadyFired=!0);const o=d.ALWAYS_SYNC_GLOBAL_EVENTS.has(t);if(o&&!e||!o&&e)return;this.updateModelIfUsed(t);const s=d.kebabProperty(t);this.$listeners[s]?this.$emit(s,r):this.$listeners[t]&&this.$emit(t,r)}}mounted(){this.emitRowModel=this.debounce(()=>{this.$emit("data-model-changed",Object.freeze(this.getRowData()))},20);const e=new w(this),t=D.combineAttributesAndGridOptions(this.gridOptions,this);this.checkForBindingConflicts();const r=this.getRowDataBasedOnBindings();r!==D.VUE_OMITTED_PROPERTY&&(t.rowData=r);const o={globalEventListener:this.globalEventListenerFactory().bind(this),globalSyncEventListener:this.globalEventListenerFactory(!0).bind(this),frameworkOverrides:new L(this),providedBeanInstances:{frameworkComponentWrapper:e},modules:this.modules};this.api=b(this.$el,t,o),this.gridCreated=!0}destroyed(){var e;this.gridCreated&&((e=this.api)==null||e.destroy(),this.isDestroyed=!0)}checkForBindingConflicts(){const e=this;(e.rowData||this.gridOptions.rowData)&&e.rowDataModel&&console.warn("AG Grid: Using both rowData and rowDataModel. rowData will be ignored.")}getRowData(){var e;const t=[];return(e=this.api)==null||e.forEachNode(r=>{t.push(r.data)}),t}updateModelIfUsed(e){this.gridReadyFired&&this.$listeners["data-model-changed"]&&d.ROW_DATA_EVENTS.has(e)&&this.emitRowModel&&this.emitRowModel()}getRowDataBasedOnBindings(){const e=this,t=e.rowDataModel;return t||(e.rowData?e.rowData:e.gridOptions.rowData)}debounce(e,t){let r;return()=>{const o=function(){e()};window.clearTimeout(r),r=window.setTimeout(o,t)}}};d.ROW_DATA_EVENTS=new Set(["rowDataUpdated","cellValueChanged","rowValueChanged"]),d.ALWAYS_SYNC_GLOBAL_EVENTS=new Set([M.EVENT_GRID_PRE_DESTROYED]),u([f(Boolean)],d.prototype,"autoParamsRefresh",2),u([f({default:()=>[]})],d.prototype,"componentDependencies",2),u([f({default:()=>[]})],d.prototype,"modules",2),d=u([I("agGridVue"),R({props:$,computed:S,watch:V,model:B})],d);export{d as AgGridVue};
